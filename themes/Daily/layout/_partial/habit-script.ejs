<script>

  var btn = $("#habitButton2-inside");
  var form = $("#habit-form");
  form.on('submit', check)

  // 各radioにvalueが入っているかcheck
  // 入ってたらfirestoreにデータ保存
  async function check(e) {
    e.preventDefault()
    if ((document.form1.radio00.value) && (document.form1.radio01.value) && (document.form1.radio02.value) &&
      (document.form1.radio03.value) && (document.form1.radio04.value)) {

      //submit buttonを有効にする
      btn.disabled = "false";
      alert("登録しました！あなたの習慣に合わせたアドバイスをします。");

      var user = firebase.auth().currentUser

      await firebase.firestore().collection('user').doc(`${user.uid}`)
        .set({
          habit: {
            'radio00': document.form1.radio00.value,
            'radio01': document.form1.radio01.value,
            'radio02': document.form1.radio02.value,
            'radio03': document.form1.radio03.value,
            'radio04': document.form1.radio04.value,
          }
        }, { merge: true })

      location.href = "/habit-2/"

    } else {

      alert("※未選択の質問があります。");
      //submit buttonを無効にする
      btn.disabled = "true";
    }
  }


  // habit登録済みか確認
  // 登録されていたら/habit-2/へ接続
  // const habitPattern = '/habit-2/'
  // const isHabitPage = !!location.href.match(habitPattern)

  // var habitRef = firebase.firestore().collection("user").doc("Hq3QlNZhc2ZizmszVe96lN6bvgA3").collection('habit');
  // // var habitRef = firebase.firestore().collection("user").doc(`${user.uid}`);
  // var getDoc = habitRef.get()
  //   .then(doc => {
  //     if (!doc.exists) {
  //       console.log('No such document!');

  //     } else {

  //       if (!isHabitPage) {
  //         location.href = '/habit-2/'

  //       }
  //     }
  //   })

  // async function check(e) {
  //   e.preventDefault()

  //   var habitRef = firebase.firestore().collection("user").doc("Hq3QlNZhc2ZizmszVe96lN6bvgA3");
  //   // var habitRef = firebase.firestore().collection("user").doc(`${user.uid}`);
  //   var getDoc = await habitRef.get()
  //     .then(doc => {
  //       if (!doc.exists) {
  //         console.log('No such document!');

  //       } else {
  //         location.href = '/habit-2/'

  //         // if (!isHabitPage) {
  //         //   location.href = '/habit-2/'

  //         // }
  //       }
  //     })
  // };


</script>